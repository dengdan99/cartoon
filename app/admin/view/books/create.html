{extend name="pub/base2" /}
{block name="title"}
<title>漫画新增</title>
{/block}

{block name="body"}
<article class="clearfix pd-20">
    <form action="{:url('create')}" method="post" id="form" class="form form-horizontal" enctype="multipart/form-data">
        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>漫画名：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <input type="text" id="inp1" class="input-text" value="" name="book_name">
            </div>
        </div>

        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3">别名：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <input type="text" class="input-text" value="" name="nick_name">
            </div>
        </div>


        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>标签：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <input type="text" id="inp2" class="input-text" value="" placeholder="各个标签用|隔开" name="tags">
            </div>
        </div>

        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>题材：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <span class="select-box" style="width:150px;">
                    <select class="select" name="tags_id" size="1">
                        {volist name="types" id="t"}
                        <option value="{$t.id}">{$t.tag_name}</option>
                        {/volist}
                    </select>
				</span>
            </div>
        </div>

        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>地区：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <span class="select-box" style="width:150px;">
                    <select class="select" name="area_id" size="1">
                        {volist name="areas" id="vo"}
                        <option value="{$vo.id}">{$vo.area_name}</option>
                        {/volist}
                    </select>
				</span>
            </div>
        </div>

        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>作者：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <input type="text" id="inp3" class="input-text" name="author">
            </div>
        </div>

        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>封面：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <input type="file" name="cover" class="input-text">
                <!-- <button type="button" class="layui-btn" id="test1">
                    <i class="layui-icon">&#xe67c;</i>上传图片
                </button> -->
            </div>
        </div>

        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>起始付费章节：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <input type="text" name="start_pay" class="input-text">
            </div>
        </div>

        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3"><span class="c-red">*</span>单章金币数：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <input type="text" name="money" class="input-text">
            </div>
        </div>

        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3">简介：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <textarea name="summary" cols="" rows="" class="textarea" dragonfly="true"
                          ></textarea>
                <p class="textarea-numberbar"><em class="textarea-length">0</em>/100</p>
            </div>
        </div>

        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3">状态：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <span class="select-box" style="width:150px;">
                    <select class="select" name="end" size="1">
                        <option value="2">连载中</option>
                        <option value="1">已完结</option>
                    </select>
				</span>
            </div>
        </div>

        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3">是否推荐：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <span class="select-box" style="width:150px;">
                    <select class="select" name="is_top" size="1">
                        <option value="2">否</option>
                        <option value="1">是</option>
                    </select>
				</span>
            </div>
        </div>
       
        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3">开启版权处理：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <span class="select-box" style="width:150px;">
                    <select class="select" name="is_copyright" size="1">
                        <option value="2">否</option>
                        <option value="1">是</option>
                    </select>
				</span>
            </div>
        </div>
      
        <div class="row clearfix">
            <label class="form-label col-xs-4 col-sm-3">正版地址：</label>
            <div class="formControls col-xs-8 col-sm-9">
                <input type="text" name="src_url" value="" class="input-text">
            </div>
        </div>

        <div class="row cl">
            <div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-3">
                <input class="btn btn-primary radius" type="submit" value="&nbsp;&nbsp;提交&nbsp;&nbsp;">
            </div>
        </div>
    </form>
</article>
{/block}
{block name="script"}
<script>
    layui.use('upload', function(){
      var upload = layui.upload;
       
      //执行实例
      var uploadInst = upload.render({
        elem: '#test1' //绑定元素
        ,url: '/upload/' //上传接口
        ,done: function(res){
          //上传完毕回调
        }
        ,error: function(){
          //请求异常回调
        }
      });
    });
</script>
<script>
    $(function () {
        $("form").validate({
            rules: {
                book_name: {
                    required: true,
                    minlength: 1,
                    maxlength: 50
                },
                tags: {
                    required: true
                },
                area_id: {
                    required: true
                },
                author: {
                    required: true
                },
                cover: {
                    required: true
                },
                start_pay: {
                    required: true,
                    digits: true,
                    number: true
                },
                money: {
                    required: true,
                    number: true,
                    digits: true,
                },
                end: {
                    required: true,
                    digits: true
                }
            },
            onkeyup: false,
            focusCleanup: false,
            success:"valid",
            submitHandler:function (form) {
                const val1 = ($('#inp1').val()).trim()
                const val2 = ($('#inp2').val()).trim()
                const val3 = ($('#inp3').val()).trim()
                if(!val1) {
                    layer.msg('请输入合法的漫画名')
                    return
                }
                if(!val2) {
                    layer.msg('请输入合法的标签')
                    return
                }
                if(!val3) {
                    layer.msg('请输入合法的作者')
                    return
                }
                subFormData('create');
            }
        });
    });

</script>
{/block}